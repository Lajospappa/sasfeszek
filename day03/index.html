<!DOCTYPE html>
<html lang="hu">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DAY03 lista nézet</title>

  <link rel="stylesheet" href="../assets/css/style.css">

  <!-- Leaflet -->
  <!-- DAY03 háttér -->
  <style>
    body.day03 {
      background: url("../images/day03/01_kehlsteinhaus_sasfeszek_parkolo.jpg") center / cover no-repeat fixed;
    }

    /* szövegdoboz háttér picit sötétebb */
    .card {
      background: rgba(0, 0, 0, 0.72);
    }

    /* --- SZÁMOZOTT KÉK POI JELÖLŐ --- */
    .poi-numbered-icon {
      background: transparent;
      border: none;
    }

    .poi-numbered-icon svg {
      display: block;
    }
  </style>
  <!-- Leaflet (térkép) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Leaflet GPX plugin (ha később kell) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.7.0/gpx.min.js"></script>
  <script src="../assets/js/gps.js"></script>
</head>

<body class="day03">
  <div class="page">

    <!-- TOPBAR -->
    <div class="topbar">
      <div class="inner">
        <div class="brand">
          <div class="title">Sasfészek túra</div>
          <div class="subtitle">DAY03 lista nézet</div>
        </div>
        <div class="btnrow">
          <a class="btn" href="../index.html">🏠 Főoldal</a>
          <button class="btn btn-accent" id="btnNearest">📌 Legközelebbi pont</button>
        </div>
      </div>
    </div>

    <!-- CONTENT -->
    <div class="container">

      <div class="card">
        <div class="h1">DAY03 – Königssee → Hallstatt</div>
        <div class="small">
          A mérés automatikusan indul oldalnyitáskor, majd 5 mp múlva frissít.
          A távolságok minden célpontnál frissülnek, és az oldal a legvalószínűbb következő pontra ugrik.
        </div>
        <div class="notice" id="gpsNotice" style="display:none">
          A böngésző nem tudott helyet kérni. Ellenőrizd a helymeghatározási engedélyt (Telefon: beállítások → Böngésző
          → Hely).
        </div>
      </div>

      <div style="height:14px"></div>

      <div class="grid" id="poiList">
        
        <!-- P1 -->
        <div class="poi" id="p1">
          <div class="poi-head">
            <div>
              <div class="poi-title">1. Kehlsteinhaus (A Sasfészek) – Obersalzberg parkoló</div>
              <div class="coords">47.630588, 13.041697</div>
            </div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p1"></span><span data-badgetext="p1">mérés:
                  várakozás</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p1">távolság: —</span></span>
            </div>
          </div>

          <div class="p">A nácik egykori reprezentációs teaháza 1834 méteren. Obersalzbergnél ér véget a közúti szakasz, innen busz és lift visz fel a csúcsra.</div>

          <div class="poibtns">
            <a class="btn btn-accent" href="p1.html">Részletek</a>
            <a class="btn btn-blue" href="https://www.google.com/maps/search/?api=1&amp;query=47.630588,13.041697" target="_blank" rel="noopener">🧭 Navigáció</a>
</div>
          

          <img class="inline-image" src="../images/day03/01_kehlsteinhaus_sasfeszek_parkolo.jpg" alt="Kehlsteinhaus (A Sasfészek) – Obersalzberg parkoló">

        </div>

        <!-- P2 -->
        <div class="poi" id="p2">
          <div class="poi-head">
            <div>
              <div class="poi-title">2. Pass Gschütt (Gschütt-hágó)</div>
              <div class="coords">47.590123, 13.432658</div>
            </div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p2"></span><span data-badgetext="p2">mérés:
                  várakozás</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p2">távolság: —</span></span>
            </div>
          </div>

          <div class="p">957 méter magas hágó a B166-os úton, Salzburg (Tennengau) és a Salzkammergut között.</div>

          <div class="poibtns">
            <a class="btn btn-accent" href="p2.html">Részletek</a>
            <a class="btn btn-blue" href="https://www.google.com/maps/search/?api=1&amp;query=47.590123,13.432658" target="_blank" rel="noopener">🧭 Navigáció</a>
</div>
          

          <img class="inline-image" src="../images/day03/02_pass_gschuett_gschuett_hago.jpg" alt="Pass Gschütt (Gschütt-hágó)">

        </div>

        <!-- P3 -->
        <div class="poi" id="p3">
          <div class="poi-head">
            <div>
              <div class="poi-title">3. Gosau-völgy (A Dachstein előszobája)</div>
              <div class="coords">47.584321, 13.535874</div>
            </div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p3"></span><span data-badgetext="p3">mérés:
                  várakozás</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p3">távolság: —</span></span>
            </div>
          </div>

          <div class="p">Széles, jégkorszaki eredetű völgy a Dachstein tömbjének előterében, alpesi legelőkkel és hegyi panorámával.</div>

          <div class="poibtns">
            <a class="btn btn-accent" href="p3.html">Részletek</a>
            <a class="btn btn-blue" href="https://www.google.com/maps/search/?api=1&amp;query=47.584321,13.535874" target="_blank" rel="noopener">🧭 Navigáció</a>
</div>
          

          <img class="inline-image" src="../images/day03/03_gosau_volgy_dachstein_elo_szobaja.jpg" alt="Gosau-völgy (A Dachstein előszobája)">

        </div>

        <!-- P4 -->
        <div class="poi" id="p4">
          <div class="poi-head">
            <div>
              <div class="poi-title">4. Hallstatt (A Világörökség szíve)</div>
              <div class="coords">47.553085, 13.647849</div>
            </div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p4"></span><span data-badgetext="p4">mérés:
                  várakozás</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p4">távolság: —</span></span>
            </div>
          </div>

          <div class="p">A hegyoldal és a tó közé szorult, teraszos település, 7000 éves sóbányászati múlttal és világörökségi jelentőséggel.</div>

          <div class="poibtns">
            <a class="btn btn-accent" href="p4.html">Részletek</a>
            <a class="btn btn-blue" href="https://www.google.com/maps/search/?api=1&amp;query=47.553085,13.647849" target="_blank" rel="noopener">🧭 Navigáció</a>
</div>
          

          <img class="inline-image" src="../images/day03/04_hallstatt.jpg" alt="Hallstatt (A Világörökség szíve)">

        </div>

        <!-- P5 -->
        <div class="poi" id="p5">
          <div class="poi-head">
            <div>
              <div class="poi-title">5. Camping Klausner-Höll (Berchtesgaden)</div>
              <div class="coords">47.63090, 13.00085</div>
            </div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p5"></span><span data-badgetext="p5">mérés:
                  várakozás</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p5">távolság: —</span></span>
            </div>
          </div>

          <div class="p">Kisebb, családias kemping Berchtesgadenben, a Königssee és a Watzmann között. Október 1–15. között korlátozott üzemmódban fogad lakókocsit és lakóautót, <b>zuhany és WC nélkül</b>, de árammal, camperservice-szel és WIFI-vel.</div>

          <div class="poibtns">
            <a class="btn btn-accent" href="p5.html">Részletek</a>
            <a class="btn btn-blue" href="https://www.google.com/maps/dir/?api=1&amp;origin=Current+Location&amp;destination=47.63090,13.00085" target="_blank" rel="noopener">🧭 Navigáció</a>
          </div>

          <img class="inline-image" src="../images/day03/Camping Klausner-Höll.png" alt="Camping Klausner-Höll (Berchtesgaden)">

        </div>


      </div>

      <!-- TÉRKÉP AZ OLDAL ALJÁN -->
      <div style="height:16px"></div>
      <div class="card">
        <div class="h1">Térkép</div>
        <div id="map" style="width:100%; height:360px; border-radius:12px;"></div>
      </div>

    </div>
  </div>
  <script>
  /* global L */
  (function(){
    "use strict";

    var el = document.getElementById("map");
    if(!el){ return; }

    // Alaptérkép
    var map = L.map("map", { scrollWheelZoom: true });
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "&copy; OpenStreetMap"
    }).addTo(map);

    // POI-k kigyűjtése a listából
    var poiEls = document.querySelectorAll(".poi");
    var pts = [];
    poiEls.forEach(function(poi){
      var c = poi.querySelector(".coords");
      var t = poi.querySelector(".poi-title");
      if(!c){ return; }
      var txt = (c.textContent || "").trim();

      // várjuk: "47.123, 15.456" vagy "47.123,15.456"
      var m = txt.match(/(-?\d+(?:\.\d+)?)\s*,\s*(-?\d+(?:\.\d+)?)/);
      if(!m){ return; }

      var lat = parseFloat(m[1]);
      var lon = parseFloat(m[2]);
      if(!isFinite(lat) || !isFinite(lon)){ return; }

      var name = t ? (t.textContent || "").trim() : "";
      var marker = L.marker([lat, lon]).addTo(map);
      if(name){ marker.bindPopup(name); }
      pts.push([lat, lon]);
    });

    // Kezdő nézet
    if(pts.length){
      map.fitBounds(pts, { padding:[18,18] });
    } else {
      map.setView([47.0, 14.0], 7);
    }
  
    // --- AKTUÁLIS POZÍCIÓ (PIROS) ---
    var meDot = null;
    var meAcc = null;
    var didCenter = false;

    function setMe(lat, lon, acc){
      var ll = [lat, lon];

      if(!meDot){
        meDot = L.circleMarker(ll, {
          radius: 7,
          color: "#ff2d2d",
          weight: 3,
          fillColor: "#ff2d2d",
          fillOpacity: 0.9
        }).addTo(map).bindPopup("Aktuális pozíció");

        meAcc = L.circle(ll, {
          radius: Math.max(10, acc || 0),
          color: "#ff2d2d",
          weight: 1,
          fillColor: "#ff2d2d",
          fillOpacity: 0.12
        }).addTo(map);

        if(!didCenter){
          // első fix: középre teszi, de nem rombolja szét a fitBounds-ot
          try { map.setView(ll, Math.min(14, map.getZoom() || 14)); } catch(e){}
          didCenter = true;
        }
      } else {
        meDot.setLatLng(ll);
        meAcc.setLatLng(ll);
        if(acc && isFinite(acc)){
          meAcc.setRadius(Math.max(10, acc));
        }
      }
    }

    if(navigator.geolocation){
      navigator.geolocation.watchPosition(function(pos){
        var c = pos && pos.coords ? pos.coords : null;
        if(!c){ return; }
        setMe(c.latitude, c.longitude, c.accuracy);
      }, function(err){
        // csendben hagyjuk (engedély/hiba)
      }, {
        enableHighAccuracy: true,
        maximumAge: 5000,
        timeout: 12000
      });
    }
})();
  </script>
</body>

</html>




